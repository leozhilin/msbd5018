# HKDT ç¨³å®šå¸é¡¹ç›®

ä¸€ä¸ªå®Œæ•´çš„å»ä¸­å¿ƒåŒ–ç¨³å®šå¸æ”¯ä»˜ç³»ç»Ÿï¼ŒåŒ…å«ç¨³å®šå¸å‘è¡Œã€æ”¯ä»˜ç½‘å…³å’Œå‰ç«¯æ¼”ç¤ºã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

HKDT (HongKong Dollar Token) æ˜¯ä¸€ä¸ª1:1é”šå®šæ¸¯å¸çš„ç¨³å®šå¸é¡¹ç›®ï¼Œæ”¯æŒï¼š
- âœ… ç¨³å®šå¸é“¸é€ ï¼ˆMintï¼‰
- âœ… ç¨³å®šå¸èµå›ï¼ˆRedeem/Burnï¼‰
- âœ… æ”¯ä»˜ç½‘å…³ï¼ˆPaymentGatewayï¼‰
- âœ… å‰ç«¯æ”¯ä»˜æ¼”ç¤º
- âœ… å•†æˆ·åå°ç›‘å¬

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 16.0.0
- npm æˆ– yarn
- MetaMask æµè§ˆå™¨æ‰©å±•

### å®Œæ•´æµç¨‹

#### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

#### 2. ç¼–è¯‘åˆçº¦

```bash
npm run compile
```

#### 3. è¿è¡Œæµ‹è¯•ï¼ˆå¯é€‰ï¼‰

```bash
npm test
```

#### 4. å¯åŠ¨æœ¬åœ°ç½‘ç»œ

**æ‰“å¼€ç»ˆç«¯1**ï¼Œè¿è¡Œï¼š

```bash
npm run node
```

**é‡è¦**ï¼šä¿æŒè¿™ä¸ªç»ˆç«¯çª—å£æ‰“å¼€ï¼ä½ ä¼šçœ‹åˆ°ï¼š
```
Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/
```

#### 5. éƒ¨ç½²åˆçº¦

**æ‰“å¼€ç»ˆç«¯2**ï¼ˆæ–°çª—å£ï¼‰ï¼Œè¿è¡Œï¼š

```bash
# éƒ¨ç½²HKDTåˆçº¦
npm run deploy:local

# éƒ¨ç½²PaymentGatewayåˆçº¦
npm run deploy:gateway
```

#### 6. å¯åŠ¨å‰ç«¯

**åœ¨ç»ˆç«¯2**ï¼Œ**ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•**ï¼ˆä¸æ˜¯frontendç›®å½•ï¼‰ï¼Œè¿è¡Œï¼š

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨Pythonï¼ˆæ¨èï¼‰
python -m http.server 8000

# æ–¹æ³•2ï¼šä½¿ç”¨Node.js http-server
npx http-server -p 8000
```

ç„¶åè®¿é—®ï¼š**http://localhost:8000/frontend/**

**é‡è¦**ï¼š
- âœ… ä»**é¡¹ç›®æ ¹ç›®å½•**å¯åŠ¨æœåŠ¡å™¨ï¼ˆä¸æ˜¯frontendç›®å½•ï¼‰
- âœ… è®¿é—®åœ°å€æ˜¯ `http://localhost:8000/frontend/`ï¼ˆä¸æ˜¯æ ¹è·¯å¾„ï¼‰
- âœ… è¿™æ ·å‰ç«¯å¯ä»¥è‡ªåŠ¨è¯»å–æ ¹ç›®å½•çš„JSONæ–‡ä»¶

#### 7. è®¿é—®å‰ç«¯

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8000

#### 8. è¿æ¥é’±åŒ…å¹¶æµ‹è¯•

1. ç‚¹å‡»"è¿æ¥é’±åŒ…"æŒ‰é’®
2. åœ¨MetaMaskä¸­ç¡®è®¤è¿æ¥
3. ç¡®ä¿MetaMaskè¿æ¥åˆ°æœ¬åœ°ç½‘ç»œï¼ˆChain ID: 1337ï¼‰
   - å¦‚æœç½‘ç»œä¸å­˜åœ¨ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨æ·»åŠ 
   - æˆ–æ‰‹åŠ¨æ·»åŠ ï¼šç½‘ç»œåç§° `Hardhat Local`ï¼ŒRPC URL `http://127.0.0.1:8545`ï¼ŒChain ID `1337`
4. å¦‚æœä½™é¢ä¸º0ï¼Œéœ€è¦å…ˆé“¸å¸ï¼ˆè§ä¸‹æ–¹ï¼‰

#### 9. ç»™è´¦æˆ·é“¸å¸ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœMetaMaskè´¦æˆ·çš„HKDTä½™é¢ä¸º0ï¼Œè¿è¡Œï¼š

```bash
# ç¼–è¾‘ scripts/mint-simple.jsï¼Œä¿®æ”¹ç›®æ ‡åœ°å€
# ç„¶åè¿è¡Œï¼š
npx hardhat run scripts/mint-simple.js --network localhost
```

#### 10. å¯åŠ¨å•†æˆ·ç›‘å¬ï¼ˆå¯é€‰ï¼‰

**æ‰“å¼€ç»ˆç«¯3**ï¼Œè¿è¡Œï¼š

```bash
npm run merchant
```

å½“æœ‰ç”¨æˆ·æ”¯ä»˜æ—¶ï¼Œè¿™ä¸ªç»ˆç«¯ä¼šæ˜¾ç¤ºæ”¯ä»˜é€šçŸ¥ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
hkdt/
â”œâ”€â”€ contracts/              # æ™ºèƒ½åˆçº¦
â”‚   â”œâ”€â”€ HKDT.sol           # HKDTç¨³å®šå¸åˆçº¦
â”‚   â””â”€â”€ PaymentGateway.sol   # æ”¯ä»˜ç½‘å…³åˆçº¦
â”œâ”€â”€ scripts/                 # éƒ¨ç½²å’Œå·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ deploy.js            # éƒ¨ç½²HKDTåˆçº¦
â”‚   â”œâ”€â”€ deploy-payment-gateway.js  # éƒ¨ç½²PaymentGateway
â”‚   â”œâ”€â”€ interact.js          # äº¤äº’æ¼”ç¤ºè„šæœ¬
â”‚   â”œâ”€â”€ merchant-listener.js # å•†æˆ·ç›‘å¬è„šæœ¬
â”‚   â””â”€â”€ mint-simple.js       # ç»™æŒ‡å®šåœ°å€é“¸å¸
â”œâ”€â”€ test/                    # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ hkdt-test.js         # HKDTåˆçº¦æµ‹è¯•
â”œâ”€â”€ frontend/                # å‰ç«¯é¡µé¢
â”‚   â”œâ”€â”€ index.html           # å‰ç«¯HTML
â”‚   â””â”€â”€ app.js               # å‰ç«¯JavaScriptï¼ˆè‡ªåŠ¨è¯»å–åˆçº¦åœ°å€ï¼‰
â”œâ”€â”€ hardhat.config.js        # Hardhaté…ç½®
â”œâ”€â”€ package.json             # é¡¹ç›®é…ç½®
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### HKDT ç¨³å®šå¸åˆçº¦

- **é“¸å¸ (Mint)**ï¼šåªæœ‰ownerå¯ä»¥ç»™ç”¨æˆ·é“¸é€ HKDT
- **èµå› (Redeem)**ï¼šç”¨æˆ·å¯ä»¥é”€æ¯HKDTï¼Œè§¦å‘é“¾ä¸‹é€€æ¬¾æµç¨‹
- **æš‚åœ/æ¢å¤**ï¼šç´§æ€¥æƒ…å†µä¸‹å¯ä»¥æš‚åœæ‰€æœ‰æ“ä½œ

### PaymentGateway æ”¯ä»˜ç½‘å…³

- **æ”¯ä»˜åŠŸèƒ½**ï¼šç”¨æˆ·ä½¿ç”¨HKDTæ”¯ä»˜è®¢å•
- **è®¢å•ç®¡ç†**ï¼šè®°å½•è®¢å•ä¿¡æ¯å’ŒçŠ¶æ€
- **äº‹ä»¶é€šçŸ¥**ï¼šè§¦å‘PaymentReceivedäº‹ä»¶ä¾›å•†æˆ·ç›‘å¬

### å‰ç«¯æ”¯ä»˜æ¼”ç¤º

- **é’±åŒ…è¿æ¥**ï¼šè‡ªåŠ¨è¿æ¥MetaMask
- **ä½™é¢æ˜¾ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºHKDTä½™é¢
- **æ”¯ä»˜åŠŸèƒ½**ï¼šæ”¯æŒé€šè¿‡PaymentGatewayæ”¯ä»˜
- **è®¢å•å†å²**ï¼šæ˜¾ç¤ºæœ€è¿‘æ”¯ä»˜è®°å½•
- **è‡ªåŠ¨é…ç½®**ï¼šè‡ªåŠ¨è¯»å–éƒ¨ç½²ä¿¡æ¯ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®

## ğŸ“ å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | åœ¨å“ªä¸ªç»ˆç«¯ |
|------|------|-----------|
| `npm run node` | å¯åŠ¨æœ¬åœ°ç½‘ç»œ | ç»ˆç«¯1ï¼ˆä¿æŒè¿è¡Œï¼‰ |
| `npm run deploy:local` | éƒ¨ç½²HKDTåˆçº¦ | ç»ˆç«¯2 |
| `npm run deploy:gateway` | éƒ¨ç½²PaymentGateway | ç»ˆç«¯2 |
| `npm run interact` | äº¤äº’æ¼”ç¤º | ç»ˆç«¯2 |
| `npm run merchant` | å•†æˆ·ç›‘å¬ | ç»ˆç«¯3 |
| `npm test` | è¿è¡Œæµ‹è¯• | ä»»æ„ç»ˆç«¯ |
| `npm run compile` | ç¼–è¯‘åˆçº¦ | ä»»æ„ç»ˆç«¯ |

## ğŸ”„ é‡å¯æµç¨‹

å¦‚æœé‡å¯äº† `hardhat node`ï¼Œéœ€è¦ï¼š

1. **é‡æ–°éƒ¨ç½²åˆçº¦**
   ```bash
   npm run deploy:local
   npm run deploy:gateway
   ```

2. **åˆ·æ–°å‰ç«¯é¡µé¢**
   - å‰ç«¯ä¼šè‡ªåŠ¨è¯»å–æœ€æ–°çš„åˆçº¦åœ°å€
   - æ— éœ€æ‰‹åŠ¨ä¿®æ”¹ä»£ç 

3. **é‡æ–°é“¸å¸**ï¼ˆå¦‚æœéœ€è¦ï¼‰
   ```bash
   npx hardhat run scripts/mint-simple.js --network localhost
   ```

## âš ï¸ é‡è¦æç¤º

1. **ä¿æŒ hardhat node è¿è¡Œ**
   - å…³é—­ `npm run node` çš„ç»ˆç«¯ = ç½‘ç»œåœæ­¢ = éœ€è¦é‡æ–°éƒ¨ç½²

2. **MetaMask ç½‘ç»œé…ç½®**
   - å¿…é¡»è¿æ¥åˆ°æœ¬åœ°ç½‘ç»œï¼ˆChain ID: 1337ï¼‰
   - ä½¿ç”¨æµ‹è¯•ETHï¼ˆhardhat nodeè‡ªåŠ¨åˆ†é…ï¼‰ï¼Œä¸æ˜¯çœŸå®ETH

3. **è´¦æˆ·ä½™é¢**
   - hardhat node çš„20ä¸ªæµ‹è¯•è´¦æˆ·æ¯ä¸ªéƒ½æœ‰10000 ETHï¼ˆæµ‹è¯•å¸ï¼‰
   - å¯ä»¥åœ¨MetaMaskä¸­å¯¼å…¥è¿™äº›è´¦æˆ·çš„ç§é’¥
   - æˆ–è€…ç»™å½“å‰è´¦æˆ·è½¬è´¦æµ‹è¯•ETH

4. **åˆçº¦åœ°å€**
   - æ¯æ¬¡é‡æ–°éƒ¨ç½²ï¼Œåˆçº¦åœ°å€ä¼šå˜åŒ–
   - å‰ç«¯ä¼šè‡ªåŠ¨è¯»å–ï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹

## ğŸ¯ æ¼”ç¤ºæµç¨‹

1. å¯åŠ¨æœ¬åœ°ç½‘ç»œ â†’ `npm run node`
2. éƒ¨ç½²åˆçº¦ â†’ `npm run deploy:local` + `npm run deploy:gateway`
3. å¯åŠ¨å‰ç«¯ â†’ `cd frontend && python -m http.server 8000`
4. è¿æ¥é’±åŒ… â†’ åœ¨æµè§ˆå™¨ä¸­ç‚¹å‡»"è¿æ¥é’±åŒ…"
5. ç»™è´¦æˆ·é“¸å¸ â†’ `npx hardhat run scripts/mint-simple.js --network localhost`
6. æµ‹è¯•æ”¯ä»˜ â†’ åœ¨å‰ç«¯è¾“å…¥å•†æˆ·åœ°å€å’Œé‡‘é¢ï¼Œç‚¹å‡»æ”¯ä»˜
7. æŸ¥çœ‹é€šçŸ¥ â†’ å•†æˆ·ç›‘å¬ç»ˆç«¯ä¼šæ˜¾ç¤ºæ”¯ä»˜é€šçŸ¥

## ğŸ“š æŠ€æœ¯æ ˆ

- **æ™ºèƒ½åˆçº¦**ï¼šSolidity 0.8.20
- **å¼€å‘æ¡†æ¶**ï¼šHardhat
- **åˆçº¦åº“**ï¼šOpenZeppelin
- **å‰ç«¯**ï¼šåŸç”ŸJavaScript + ethers.js
- **é’±åŒ…**ï¼šMetaMask

## ğŸ”— ç›¸å…³èµ„æº

- [Hardhatæ–‡æ¡£](https://hardhat.org/docs)
- [OpenZeppelinåˆçº¦åº“](https://docs.openzeppelin.com/contracts)
- [Ethers.jsæ–‡æ¡£](https://docs.ethers.org/)
- [MetaMaskæ–‡æ¡£](https://docs.metamask.io/)

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ³¨æ„**ï¼šè¿™æ˜¯ä¸€ä¸ªæ•™å­¦æ¼”ç¤ºé¡¹ç›®ï¼Œä¸åº”ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚ç”Ÿäº§ç¯å¢ƒéœ€è¦é¢å¤–çš„å®‰å…¨å®¡è®¡ã€åˆè§„æ£€æŸ¥å’Œé£é™©ç®¡ç†æœºåˆ¶ã€‚
